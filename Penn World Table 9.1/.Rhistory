ggsave('econ_policy.png', width = 8*1.2, height = 5*1.2, type = 'cairo')
df %>%
filter(!is.na(left_right)) %>%
group_by(left_right) %>%
summarise_at(vars(free_educ,prog_tax,fiscal_stimulus,public_works,small_gov,cons_tax), ~mean(6 - .x,na.rm=T)) %>%
rename(`Free education through university` = free_educ, `Progressive taxation` = prog_tax, `Fiscal stimulus over austerity` = fiscal_stimulus, `Public works to protect employment` = public_works, `Prefer small government` = small_gov, `Raise consumption tax` = cons_tax) %>%
gather(key = 'Policy', value = 'Average support',-left_right) %>%
ggplot(aes(x=left_right,y=`Average support`)) +
geom_bar(stat = 'identity', fill = '#1f77b4') +
facet_wrap(~Policy) +
coord_flip() +
theme_bw() +
labs(x = 'Left-Right position',
y = 'Average support (1 = Strongly disagree, 5 = Strongly agree)',
title = 'Where Japanese voters stand on economic policy',
subtitle = 'Voters in the 2017 general election',
caption = 'UTokyo-Asahi Survey; John Handley') +
ggsave('econ_policy.png', width = 8*1.2, height = 5*1.2, type = 'cairo')
# Economic issues
df %>%
filter(!is.na(left_right)) %>%
group_by(left_right) %>%
summarise_at(vars(free_educ,prog_tax,fiscal_stimulus,public_works,small_gov,cons_tax), ~mean(6 - .x,na.rm=T)) %>%
rename(`Free education through university` = free_educ, `Progressive taxation` = prog_tax, `Fiscal stimulus over austerity` = fiscal_stimulus, `Public works to protect employment` = public_works, `Prefer small government` = small_gov, `Raise consumption tax` = cons_tax) %>%
gather(key = 'Policy', value = 'Average support',-left_right) %>%
ggplot(aes(x=left_right,y=`Average support`)) +
geom_bar(stat = 'identity', fill = '#1f77b4') +
facet_wrap(~Policy) +
coord_flip() +
theme_bw() +
labs(x = 'Subjective left-right position',
y = 'Average support (1 = Strongly disagree, 5 = Strongly agree)',
title = 'Where Japanese voters stand on economic policy',
subtitle = 'Voters in the 2017 general election',
caption = 'UTokyo-Asahi Survey; John Handley') +
ggsave('econ_policy.png', width = 8*1.2, height = 5*1.2, type = 'cairo')
# National security issues
df %>%
filter(!is.na(left_right)) %>%
group_by(left_right) %>%
summarise_at(vars(defence, preemtive_strike, nk_pressure, non_prolif, yasukuni, safety_privacy), ~mean(6 - .x,na.rm=T)) %>%
rename(`Strengthen national defence` = defence, `Pre-emptive strike` = preemtive_strike, `Put preasure on North Korea` = nk_pressure, `Nuclear non-proliferation` = non_prolif, `PM at Yasukuni shrine` = yasukuni, `Safety over privacy` = safety_privacy) %>%
gather(key = 'Policy', value = 'Average support',-left_right) %>%
ggplot(aes(x=left_right,y=`Average support`)) +
geom_bar(stat = 'identity', fill = '#1f77b4') +
facet_wrap(~Policy) +
coord_flip() +
theme_bw() +
labs(x = 'Subjective left-right position',
y = 'Average support (1 = Strongly disagree, 5 = Strongly agree)',
title = 'Where Japanese voters stand on foreign/security policy',
subtitle = 'Voters in the 2017 general election',
caption = 'UTokyo-Asahi Survey; John Handley') +
ggsave('foreign_policy.png', width = 8*1.2, height = 5*1.2, type = 'cairo')
# Social issues
df %>%
filter(!is.na(left_right)) %>%
group_by(left_right) %>%
summarise_at(vars(migrant_worker, restart_nuclear, maiden_name, gay_marriage, pol_age, unicam), ~mean(6 - .x,na.rm=T)) %>%
rename(`Allow more migrant workers` = migrant_worker,
`Restart nuclear power plants` = restart_nuclear,
`Allow wives to keep their maiden names` = maiden_name,
`Legalise gay marriage` = gay_marriage,
`Lower age to run for office` = pol_age,
`Unicameral legislature` = unicam) %>%
gather(key = 'Policy', value = 'Average support',-left_right) %>%
ggplot(aes(x=left_right,y=`Average support`)) +
geom_bar(stat = 'identity', fill = '#1f77b4') +
facet_wrap(~Policy) +
coord_flip() +
theme_bw() +
labs(x = 'Subjective left-right position',
y = 'Average support (1 = Strongly disagree, 5 = Strongly agree)',
title = 'Where Japanese voters stand on domestic policy and social issues',
subtitle = 'Voters in the 2017 general election',
caption = 'UTokyo-Asahi Survey; John Handley') +
ggsave('domestic_policy.png', width = 8*1.2, height = 5*1.2, type = 'cairo')
# Political compass
df %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(econ = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(nationalist_internationalist = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(progressive_conservative = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(econ,nationalist_internationalist,progressive_conservative), ~scale(.x)) %>%
select(left_right,econ,nationalist_internationalist,progressive_conservative)
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(econ = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(nationalist_internationalist = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(progressive_conservative = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(econ,nationalist_internationalist,progressive_conservative), ~scale(.x)) %>%
select(left_right,econ,nationalist_internationalist,progressive_conservative)
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(econ = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(nationalist_internationalist = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(progressive_conservative = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(econ,nationalist_internationalist,progressive_conservative), ~scale(.x)[,1]) %>%
select(left_right,econ,nationalist_internationalist,progressive_conservative)
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right scale` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism scale` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism scale` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right scale`,`Nationalism-Internationalism scale`,`Progressivism-Conservatism scale`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right scale`,`Nationalism-Internationalism scale`,`Progressivism-Conservatism scale`)
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism scale`,`Progressivism-Conservatism scale`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`) %>%
gather('Axis','Position',-left_right)
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`) %>%
gather('Axis','Position',-left_right)
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`) %>%
gather('Axis','Position',-left_right) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4)
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
ggplot(aes(x=left_right,y=`Economic left-right`)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
group_by(left_right) %>%
summarise_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`),~mean(.x))
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax - fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
group_by(left_right) %>%
summarise_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`),~mean(.x))
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax - fiscal_stimulus + public_works - small_gov) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax - fiscal_stimulus + public_works - small_gov + cons_tax) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax - fiscal_stimulus + public_works - small_gov - cons_tax) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + public_works - small_gov - cons_tax) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + public_works - small_gov - cons_tax - fiscal_stimulus) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = free_educ + prog_tax + public_works - small_gov + cons_tax + fiscal_stimulus) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Economic left-right` = cons_tax + fiscal_stimulus) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Economic left-right`,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:4) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
# Political compass
df %>%
filter(!is.na(left_right)) %>%
filter_at(vars(starts_with('Q23_')),~!is.na(.x)) %>%
mutate(`Nationalism-Internationalism` = defence + preemtive_strike + nk_pressure - non_prolif + yasukuni + safety_privacy) %>%
mutate(`Progressivism-Conservatism` = -migrant_worker + restart_nuclear - maiden_name - gay_marriage - pol_age) %>%
mutate_at(vars(`Nationalism-Internationalism`,`Progressivism-Conservatism`), ~scale(.x)[,1]) %>%
select(left_right,`Nationalism-Internationalism`,`Progressivism-Conservatism`)%>%
gather('Axis','Position',2:3) %>%
ggplot(aes(x=left_right,y=Position,color=Axis)) +
geom_smooth()
setwd("~/Python Projects/LIS redistribution")
setwd("~/Python Projects/LIS redistribution")
library(tidyverse)
df <- read_csv('poverty_redist.csv')
df
df %>%
mutate(decade = round(year,-1))
?round
df %>%
mutate(decade = floor(year,-1))
df %>%
mutate(decade = floor(year/10)*10)
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(decade) %>%
filter(first(decade))
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(decade) %>%
filter(first(year))
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country) %>%
filter(first(decade))
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country)
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country,decade) %>%
filter(year == first(year))
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country,decade) %>%
filter(if_else(decade == 2010, year == last(year),year == first(year)))
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country,decade) %>%
filter(if_else(decade == 2010, year == last(year),year == first(year))) %>%
ungroup() %>%
filter(decade %in% c(1980,2010))
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country,decade) %>%
filter(if_else(decade == 2010, year == last(year),year == first(year))) %>%
ungroup() %>%
filter(decade %in% c(1980,2010)) -> data
library(ggrepel)
data %>%
filter(decade == 2010) %>%
ggplot(aes(x=primary,y=redist,label=country)) +
geom_point() +
geom_text_repel()
data %>%
filter(decade == 2010) %>%
ggplot(aes(x=primary,y=redist,label=country)) +
geom_point() +
geom_text_repel() +
geom_smooth(method='lm')
df <- read_csv('poverty_redist_all.csv')
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country,decade) %>%
filter(if_else(decade == 2010, year == last(year),year == first(year))) %>%
ungroup() %>%
filter(decade %in% c(1980,2010)) -> data
data %>%
filter(decade == 2010) %>%
ggplot(aes(x=primary,y=redist,label=country)) +
geom_point() +
geom_text_repel() +
geom_smooth(method='lm')
data %>%
filter(decade == 2010) %>%
ggplot(aes(x=primary,y=redist,label=country)) +
geom_point() +
geom_text_repel() +
geom_smooth(method='lm') +
labs(x = 'Poverty rate for primary income',
y = 'Reduction in poverty by taxes and transfers')
data %>%
filter(decade == 2010) %>%
ggplot(aes(x=primary,y=redist,label=country)) +
geom_point() +
geom_text_repel() +
geom_smooth(method='lm') +
labs(x = 'Poverty rate for primary income',
y = 'Reduction in poverty by taxes and transfers'
title = 'Poverty and redistribution',
caption = 'Caminada and Wang (2019); John Handley',)
data %>%
filter(decade == 2010) %>%
ggplot(aes(x=primary,y=redist,label=country)) +
geom_point() +
geom_text_repel() +
geom_smooth(method='lm') +
labs(x = 'Poverty rate for primary income',
y = 'Reduction in poverty by taxes and transfers'
title = 'Poverty and redistribution',
caption = 'Caminada and Wang (2019); John Handley')
data %>%
filter(decade == 2010) %>%
ggplot(aes(x=primary,y=redist,label=country)) +
geom_point() +
geom_text_repel() +
geom_smooth(method='lm') +
labs(x = 'Poverty rate for primary income',
y = 'Reduction in poverty by taxes and transfers',
title = 'Poverty and redistribution',
caption = 'Caminada and Wang (2019); John Handley')
data
data %>%
group_by(country,decade) %>%
mutate(ch_primary = primary - lag(primary), ch_redist = redist - lag(redist))
data %>%
group_by(decade,country) %>%
mutate(ch_primary = primary - lag(primary), ch_redist = redist - lag(redist))
data %>%
group_by(country) %>%
mutate(ch_primary = primary - lag(primary), ch_redist = redist - lag(redist))
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country,decade) %>%
filter(if_else(decade == 2010, year == last(year),year == first(year))) %>%
ungroup() %>%
group_by(country) %>%
filter(decade %in% c(1980,2010)) -> data
data
df %>%
mutate(decade = floor(year/10)*10) %>%
group_by(country,decade) %>%
filter(if_else(decade == 2010, year == last(year),year == first(year))) %>%
ungroup() %>%
filter(decade %in% c(1980,2010)) -> data
data %>%
filter(decade == 2010) %>%
ggplot(aes(x=primary,y=redist,label=country)) +
geom_point() +
geom_text_repel() +
geom_smooth(method='lm') +
labs(x = 'Poverty rate for primary income',
y = 'Reduction in poverty by taxes and transfers',
title = 'Poverty and redistribution',
caption = 'Caminada and Wang (2019); John Handley')
data %>%
group_by(country) %>%
mutate(ch_primary = primary - lag(primary), ch_redist = redist - lag(redist)) %>%
ungroup() %>%
filter(!is.na(ch_redist))
data %>%
group_by(country) %>%
mutate(ch_primary = primary - lag(primary), ch_redist = redist - lag(redist),n = n()) %>%
ungroup()
data %>%
group_by(country) %>%
mutate(ch_primary = primary - lag(primary), ch_redist = redist - lag(redist),n = n()) %>%
ungroup() %>%
filter(n>1)
data %>%
group_by(country) %>%
mutate(ch_primary = primary - lag(primary), ch_redist = redist - lag(redist),n = n()) %>%
ungroup() %>%
filter(!is.na(ch_redist))
data %>%
group_by(country) %>%
mutate(ch_primary = primary - lag(primary), ch_redist = redist - lag(redist)) %>%
ungroup() %>%
filter(!is.na(ch_redist)) %>%
ggplot(aes(x=ch_primary,y=ch_redist,label=country)) +
geom_point() +
geom_text_repel() +
geom_smooth(method='lm') +
labs(x = 'Change in poverty rate for primary income',
y = 'Change in reduction in poverty by taxes and transfers',
title = 'Changes in poverty and redistribution from the 1980s to 2010s',
caption = 'Caminada and Wang (2019); John Handley')
setwd("~/Python Projects/Penn World Table 9.1")
library(tidyverse)
library(haven)
df <- read_dta('pwt91.dta')
df
df %>%
mutate(rgdppc = rgdpna/pop) %>%
group_by(country) %>%
mutate(rgdppc_index = log(rgdppc/first(rgdppc))) %>%
ungroup() %>%
select(country,year,rgdppc_index)
df %>%
mutate(rgdppc = rgdpna/pop) %>%
group_by(country) %>%
mutate(rgdppc_index = log(rgdppc/first(rgdppc))) %>%
ungroup() %>%
filter(!is.na(rgdppc_index))
df %>%
mutate(rgdppc = rgdpna/pop) %>%
group_by(country) %>%
mutate(rgdppc_index = log(rgdppc/first(rgdppc))) %>%
ungroup() %>%
filter(!is.na(rgdppc_index)) %>%
select(country,year,rgdppc_index)
df %>%
mutate(rgdppc = rgdpna/pop) %>%
group_by(country) %>%
mutate(rgdppc_index = log(rgdppc/first(rgdppc))) %>%
ungroup() %>%
filter(!is.na(rgdppc_index), countrycode %in% c('GBR','FRA','DEU')) %>%
select(country,year,rgdppc_index) %>%
ggplot(aes(x=year,y=rgdppc_index,color=country)) +
geom_line()
